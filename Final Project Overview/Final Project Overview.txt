
Final Project Overview:


Step 1: Understanding the dataset:

	Use the Olist E-commerce Dataset, which consists of multiple related tables covering orders, customers, products, sellers, payments, and geolocation.

	Dataset Download: Olist E-commerce Dataset

		Key Tables:

			Orders â€“ Order details (timestamps, status)

			Customers â€“ Customer info (location, ID)

			Order Items â€“ Product details in each order

			Products â€“ Product metadata

			Sellers â€“ Seller details (location, ID)

			Payments â€“ Payment transactions per order

			Geolocation â€“ Location data for customers and sellers

			Reviews â€“ Customer feedback on orders


Step 2: Data Pipeline Stages

	We will process data using three layers:

		Bronze Layer (Raw Ingestion) â€“ Load raw JSON/CSV data into ADLS Gen2.

		Silver Layer (Refined Data) â€“ Clean, standardize, and apply business logic.

		Gold Layer (Business Aggregates) â€“ Create Fact & Dimension Tables in a Star Schema.


Step 3: PySpark Transformations for Silver Layer

	The Silver Layer focuses on cleaning and structuring data before further processing.


	Transformations in Silver Layer

		âœ… 1. Standardizing Column Names
		âœ… 2. Handling Missing & Null Values
		âœ… 3. Filtering Out Unnecessary Records
		âœ… 4. Standardizing Date Formats
		âœ… 5. Deduplicating Data
		âœ… 6. Extracting and Splitting Columns
		âœ… 7. Joining Related Tables for Enrichment
		âœ… 8. Formatting Data Types (String, Integer, Date, Boolean, etc.)


Step 4: PySpark Transformations for Gold Layer

	The Gold Layer organizes data into a Star Schema with Fact & Dimension Tables.

	Fact & Dimension Tables (Star Schema)

	ðŸ“Œ Fact Table:

		FactOrders (Aggregates order details, payments, and seller transactions)

	ðŸ“Œ Dimension Tables:

		DimCustomer (Customer details)

		DimProduct (Product metadata)

		DimSeller (Seller info)

		DimDate (Date-based analysis)


	Transformations in Gold Layer:

		âœ… 1. Generating Surrogate Keys
		âœ… 2. Joining Multiple Tables to Create Facts & Dimensions
		âœ… 3. Aggregating Data for Reporting (SUM, COUNT, AVG, etc.)
		âœ… 4. Creating Slowly Changing Dimensions (SCD Type 1)
		âœ… 5. Optimizing for Query Performance (Partitioning, Z-Ordering)




âœ… Silver Layer Transformations (Raw to Cleaned Data):


	The goal here is to clean and standardize the data before moving to the Gold layer.

		âœ…Rename Columns for Better Readability

		âœ…Convert column names from camelCase to snake_case.

		âœ…Handle Missing and Null Values

		âœ…Fill null values in categorical columns with "Unknown" or "Not Provided".

		âœ…Replace null values in numerical columns with 0 or the mean/median.

		âœ…Data Type Casting & Standardization

		âœ…Convert string-based dates to TimestampType().

		âœ…Convert price and amount fields to DecimalType() or DoubleType().

		âœ…Standardize country codes (e.g., US â†’ United States).

		âœ…Extracting Date Components : Extract year, month, day, and weekday from date columns.

		âœ…Create a derived_date_id column for joins.

		âœ…Splitting and Extracting Information

		âœ…Extract first and last names from full names.

		âœ…Split address fields into street, city, state, and zip_code.

		âœ…Combining Fields for Business Understanding : Merge first_name and last_name to create full_name.

		âœ…Combine category and sub_category into a single field.

		âœ…Remove Special Characters from Text Fields

		âœ…Remove leading/trailing spaces and unwanted characters (\t, \n, >, $, etc.).

		âœ…Data Deduplication

		âœ…Identify and remove duplicate records based on customer and order IDs.

		âœ…Standardizing Address and Location Data

		âœ…Convert city names to title case ("NEW YORK" â†’ "New York").

		âœ…Fix inconsistent state abbreviations ("CA" â†’ "California").

		âœ…Filtering Invalid Data

		âœ…Remove rows where mandatory fields (customer_id, order_id) are missing.

		âœ…Filter out transactions with negative or zero prices.


âœ… Gold Layer Transformations (Building Star Schema):

	Here, we refine the Silver data into Fact and Dimension tables.

	âœ…Dimension Tables

		âœ…DimCustomer (Customer Master Data)

			âœ…Extract unique customer details.

			âœ…Generate customer_sk (surrogate key).

			âœ…Create a column to categorize customers (New, Returning, VIP).

		âœ…DimProduct (Product Master Data)

			âœ…Extract unique products with categories.

			âœ…Generate product_sk (surrogate key).

			âœ…Add product popularity ranking.


		âœ…DimDate (Date Master Data)

			âœ…Pre-populated calendar table.

			âœ…Include week_number, fiscal_year, quarter.


		âœ…DimLocation (Geographical Data)

			âœ…Extract city, state, and country from addresses.

			âœ…Generate location_sk for better joins.


	âœ…Fact Tables

		âœ…FactSales (Transaction-Level Sales Data)

			âœ…Join order, customer, and product data.

			âœ…Generate fact_sales_sk (surrogate key).

			âœ…Add profit_margin calculation (revenue - cost).

			âœ…Implement incremental loading (new sales only).

			âœ…Store in Delta format.


	âœ…FactSalesAggregation (Summary-Level Sales Data)

		âœ…Aggregate daily/monthly sales at customer and product levels.

		âœ…Calculate total revenue, discounts, and average order value.

		âœ…Optimize table with ZORDER for faster queries.

